# 红岩网校后端研发部2022期末考核

**时间： 十六周周日(12.25)14:00-18:30**

**地点：线上**

**提交方式：Git地址发送到`be@redrock.team` 标题 姓名-学号**

**注意事项：合理利用之前的作业、课件、搜索引擎、抄袭是坏文明，如有直接复制的代码请注明!**

**小tips：合理安排时间，不要死磕一道题，业务为重，时间过后禁止`commit`**

## 基础

注：题目错误原因需要体现在题目的**main函数前注释里**

**go基础**

(a)

```Go
type user struct {
    Username string
    Nickname string
    Sex      uint8
    Birthday time.Time
}
/*json数据序列化以后，对应的属性都为空，如果结构体首字母是小写，作用域只有在 结构体内和该结构体的方法中，在外部无法访问，需要将结构体中属性首字母全部大写才能访问*/
func main() {
    u := user{
        Username: "坤坤",
        Nickname: "阿坤",
        Sex:      20,
        Birthday: time.Now(),
    }
    bs, err := json.Marshal(&u)
    if err != nil {
        log.Println(err)
        return
    }
    
    fmt.Println(string(bs))
}
```

上面的代码输出有问题，找到问题并解决ta



(b)

```Go
/* if语句中a为true,把值return给上面的defer,执行defer以后又回到if，通过return退出执行，下面的defer定义后没有调用*/
func main() {
    var a = true
    defer func() {
        fmt.Println("1")
    }()

    if a {
        fmt.Println("2")
        return
    }

    defer func() {
        fmt.Println("3")
    }()
}
```

已知以上代码输出2 1，请说明为什么3未输出



**并发相关**

(a)

Go语言里使用锁来保持逻辑同步是下下之举，可以使用管道（chan）的堵塞特性来实现同步

```Go
func main() {
        go func() {
                fmt.Println("出现")
        }()        
}
```



(b)

有时候我们在启动goroutine的时候会发现它可能并不会按照我们的想要的顺序去执行goroutine，我们可以通过channel来控制它们的顺序。

```Go
var wg sync.WaitGroup

func main() {
    wg.Add(3)
    go Work("goroutine1")
    go Work("goroutine2")
    go Work("goroutine3")
    wg.Wait()
    fmt.Println("successful")
}

func Work(workName string) {
    time.Sleep(time.Second) // 模拟逻辑处理
    fmt.Println(workName)
    wg.Done()
}
```

请用channel来实现输出如下的结果

```Go
goroutine1
goroutine2
goroutine3
successful
```

ps:可以修改Print函数（包括参数）



(c)

> **自幂数是指一个 n 位数，它的每个位上的数字的 n 次幂之和等于它本身。（例如：当n为3时，有1^3 + 5^3 + 3^3 = 153，153即是n为3时的一个自幂数）**

请使用**并发**的方式快速求出1-6位的所有自幂数



**数据库相关**

(a)

请为图书馆的借阅模块设计表结构：

- 登录注册
- 借阅记录（书本的状态：是否归还、是否逾期等）
- 书籍库

PS: 实体属性给的不全，自己拓展



(b)

说说MySQL预处理语句的好处，你认为有何使用价值



## 编码能力题

要求：使用go语言完成该题

### 坤蛋出海

#### 题目描述

阿海是个年轻的坤场主，最近听闻台湾省闹蛋慌，省内坤蛋价格飙升，学生营养餐一周只能配给一个坤蛋，阿海一听这怎么行，当即决定通过船运向台湾供应坤蛋（我要狠狠的赚上一波大米).

但是在赚大米之前需要做好一定的准备。其中之一是阿海需要一位程序员来帮他写一个算法用来满足他的统计需求。

阿海将会提供每一只船的出发时刻，每批坤蛋的品质，和坤蛋的批数

你需要设计算法计算每发出一只船，统计从船发出前24小时(86400秒)到该只船发出这段时间内所有发出的坤蛋一共有多少种不同的品质。

简单来说，就是统计满足左开右闭区间(t-86400,t]（t为当前船出发的时刻）里的所有船只，这些满足条件的船上一共有多少个批不同品质的蛋（坤蛋的品质将会用数字表示）

##### 输入格式

第一行输入正整数n，表示接下来将会有n条数据（即n条船）

接下来n行，每一行都表示一艘船的信息

每行第一个数 t 与第二个数 k 分别表示该艘船的出发时刻和该船上坤蛋的批数，接下来的 k 个数表示每批蛋的品质

保证输入的每行第一个数 t 是递增的，其单位为秒

##### 数据范围

 发出船的数量n： 1≤*n*≤10^5 

船的出发时刻t :    1≤ t ≤10^9  

所有船蛋的总批数k :      k ≤ 3*10^5

蛋的品质 x :   1 ≤ x ≤ 10^5

##### 输出格式

输出 n 行，第 i 行输出一个整数表示第 i 艘船发出后的统计信息。

##### 输入输出样例

**输入 #1**

```Plain%20Text
3
1 4 4 1 2 2
2 2 2 3
10 1 3
```

**输出 #1**

```Plain%20Text
3
4
4
```

##### **样例解释**

```Plain%20Text
样例1
第一艘船在t=1的时候发出，最近24小时内发出的只有第一艘船，船上每批蛋的品质分别为4 1 2 2，一共有1号品质的蛋，2号品质的和4号品质的蛋3种，所以输出3
第二艘船在t=2的时候发出，最近24小时内发出的有第一艘船，第二艘船，船上每批蛋的品质分别为2 3，与第一艘船相比不同品质的蛋为3号蛋，3+1=4，所以输出4
第二艘船在t=10的时候发出，最近24小时内发出的有第一艘船，第二艘船，第三艘船，船上只有3号品质的蛋，与前两艘船相比没有品质不同的蛋，所以输出4
```

**输入 #2**

```Plain%20Text
4
1 4 1 2 2 3
3 2 2 3
86401 2 3 4
86402 1 5
```

**输出 #2**

```Plain%20Text
3
3
3
4
```



##### **补充说明**

很多时候作为后端开发，我们需要处理一些非常复杂的逻辑，所以对编码能力会有较高的要求。

题目已经给出题意概述以及样例解释降低难度了，如果代码实在实现不了，叙述一下你的思路也可以。



## 业务

### **背景**

海哥和斌哥在两年半的积攒下，终于集齐了启动资金，准备大干一场，为了提高货物配送，在各地陆陆续续的建造了物流仓库，仓库每天都要接收工厂配送的货物，还要从仓库中调货出去，以及接收从别的仓库调过来的货，每天的登记让他们苦不堪言，还好，他们找到了你，请你帮他们设计一款物流管理后台。

请实现以下功能

- 后台登录
- 新增仓库
- 指定仓库货物的上下架
- 仓库货物库存的变动 即货物的出库和入库
- 跨区域调货（即从一个仓库的库存变更到另一个仓库）
- README.md 详细说明项目
- 部署在自己的服务器上

### **附加题**

- 获取指定仓库的货物
- 库存搜索，搜索指定商品在各个仓库的库存
- 扫码实现货物的出入库，既通过不同接口生成二维码扫码实现出库与入库
- 对每一次操作进行记录
- 查看指定时间段的记录
- 实现一切你能想到的新功能
- 使用一切你会的新技术 在涉及使用第三方包的时候请先询问你的导师
- 一份经过测试的接口文档